/* ==========================================================================
   CONFIG HEADER - Icon bar and quick buttons

   CEMENT: Quick buttons remain clickable even when muted
   - Three buttons: Plan (flex), Focus (fixed 50px), Session (flex)
   - Visual-only muting: buttons remain clickable for config dropdown access
   - pointer-events: auto overrides global .is-muted rule
   - 50px height constraint prevents layout shift

   Architecture: Collapsed icon bar displays current state
   - Plan button: Shows current mode or plan duration
   - Focus button: Shows muscle group icon for current/next body part
   - Session button: Shows minutes remaining with color coding

   Dependencies:
   Global: _variables.css (spacing, colors, typography, control-height, muting tokens)
   Global: _card-foundations.css, _card-headers.css, _selectors.css
   Local: config-card.header.expanded.css, config-card.header.muting.css
   ========================================================================== */

/* Global dependencies */
@import url("../../styles/components/_card-headers.css");
@import url("../../styles/components/_card-foundations.css");
@import url("../../styles/components/_selectors.css");

/* Local dependencies */
@import url("./config-card.header.expanded.css");
@import url("./config-card.header.muting.css");

/* === CARD FOUNDATION === */
/* CEMENT: Always blue border - distinguishes from other cards, never transparent */
#config-header {
  margin: 0 0 var(--space-m) 0; /* Global: 16px bottom */
  border: var(--card-border-width) solid var(--primary-blue);
  transition: border-radius 0.3s ease;
  position: relative;
  z-index: 100; /* Above other cards when expanded */
  box-shadow: none;
}

/* === CARD PADDING === */
/* CEMENT: Custom top padding compensates for blue border, achieves 16px visual */
#config-header .card-content-container {
  padding: 13px var(--card-padding-sides) var(--card-padding-sides) var(--card-padding-sides); /* 13px + 2px border + 1px = 16px visual */
  box-sizing: border-box;
  transition: padding 0.3s ease;
}

#config-header .config-header-group.collapsed ~ * {
  overflow: hidden;
}

#config-header:has(.config-header-group.collapsed) .card-content-container {
  padding-bottom: 12px; /* Reduced padding when collapsed */
}

/* === HEADER === */
#config-header .card-header-line {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  margin-bottom: var(--header-margin-bottom); /* Global: 7px visual */
  position: relative;
}

#config-header .card-header {
  font-size: var(--font-size-h2);
  font-weight: 600;
  line-height: 1;
  color: var(--on-surface-light);
  margin: 0;
  padding: 0;
  text-shadow: 0 2px 6px rgba(0, 0, 0, 0.9);
}

#config-header .card-header-clock {
  font-size: var(--font-size-h2);
  font-weight: 600;
  line-height: 1;
  color: var(--on-surface-light);
  white-space: nowrap;
  flex-shrink: 0;
  text-shadow: 0 2px 6px rgba(0, 0, 0, 0.9);
}

/* === CONFIG GROUP === */
#config-header .config-header-group {
  margin: 0;
  padding: 0;
}

/* === SELECTOR BASE STYLES === */
/* CEMENT: 50px hard constraint prevents layout shift between states */
#config-header .app-selector summary {
  min-height: var(--control-height);
  max-height: var(--control-height);
  height: var(--control-height);
  outline: none;
  user-select: none;
  -webkit-user-select: none;
}

#config-header .app-selector[open] > summary {
  box-shadow: inset 0 0 0 2px var(--primary-blue);
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0;
}

/* === ICON BAR (COLLAPSED STATE) === */
/* CEMENT: Three-button layout - flexible plan/session, fixed focus icon */
.icon-bar {
  display: flex;
  align-items: center;
  gap: var(--space-s); /* Global: 7px between buttons */
  margin-top: 0;
  padding: 0;
  font-size: 1rem;
  min-height: var(--control-height); /* Global: 50px */
}

/* === PLAN QUICK BUTTON === */
/* CEMENT: Flexible width displays mode or plan info */
.icon-bar-item.icon-plan-wide {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 8px;
  flex: 1;
  height: var(--control-height);
  min-height: var(--control-height);
  background: var(--background-dark);
  border: none;
  border-radius: var(--border-radius);
  box-shadow: inset 0 0 0 2px var(--primary-blue),
              0 2px 6px rgba(0, 0, 0, 0.3);
  cursor: pointer;
}

.icon-bar-item.icon-plan-wide .plan-text {
  line-height: 1;
  text-align: center;
}

/* CEMENT: Stacked text layout matches Superset/Partner selector spacing */
.plan-quick-button-stack {
  display: flex;
  flex-direction: column;
  padding: var(--selector-multiline-padding-top) 0 var(--selector-multiline-padding-bottom) 0;
  line-height: var(--selector-multiline-line-height);
  text-align: center;
}

.plan-quick-button-stack > span {
  font-family: "Roboto", sans-serif;
  font-size: var(--font-size-h2);
  font-weight: 500;
  line-height: inherit;
  display: block;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.plan-quick-button-stack > span:first-child {
  margin-bottom: var(--selector-multiline-line-gap);
}

.plan-quick-button-muted {
  color: var(--on-surface-medium);
}

/* === FOCUS QUICK BUTTON === */
/* CEMENT: Fixed 50px displays current body part icon */
.icon-bar-item.icon-display {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  width: 50px;
  height: var(--control-height);
  min-width: 50px;
  min-height: var(--control-height);
  background: var(--background-dark);
  border: none;
  border-radius: var(--border-radius);
  box-shadow: inset 0 0 0 2px var(--primary-blue),
              0 2px 6px rgba(0, 0, 0, 0.3);
  font-size: var(--font-size-h2);
  font-weight: 600;
  cursor: pointer;
  flex-shrink: 0;
}

.icon-bar-item.icon-display .icon-label {
  font-size: var(--font-size-h2);
  line-height: 1;
}

/* === SESSION QUICK BUTTON === */
/* CEMENT: Flexible width displays current session time */
.icon-bar-item.icon-session-wide {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 8px;
  flex: 1;
  height: var(--control-height);
  min-height: var(--control-height);
  background: var(--background-dark);
  border: none;
  border-radius: var(--border-radius);
  box-shadow: inset 0 0 0 2px var(--primary-blue),
              0 2px 6px rgba(0, 0, 0, 0.3);
  cursor: pointer;
}

.icon-bar-item.icon-session-wide .session-text {
  text-align: center;
}

.session-quick-button-stack {
  display: flex;
  flex-direction: column;
  padding: var(--selector-multiline-padding-top) 0 var(--selector-multiline-padding-bottom) 0;
  line-height: var(--selector-multiline-line-height);
  text-align: center;
}

.session-quick-button-stack > span {
  font-family: "Roboto", sans-serif;
  font-size: var(--font-size-h2);
  font-weight: 500;
  line-height: inherit;
  display: block;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.session-quick-button-stack > span:first-child {
  margin-bottom: var(--selector-multiline-line-gap);
}

/* === BUSINESS LOGIC MUTING === */
/* CEMENT: Visual-only muting - buttons remain clickable for config dropdown access */
/* Content stays visible because buttons show current state (plan, focus, session) */
/* Buttons remain interactive to allow opening config dropdown even when all selectors are muted */
/* pointer-events: auto overrides global .is-muted rule from _helpers.css */
.icon-bar-item.icon-plan-wide.is-muted {
  background: var(--muted-background);
  box-shadow: inset 0 0 0 2px var(--muted-border-color);
  pointer-events: auto;
}

.icon-bar-item.icon-display.is-muted {
  background: var(--muted-background);
  box-shadow: inset 0 0 0 2px var(--muted-border-color);
  pointer-events: auto;
}

.icon-bar-item.icon-session-wide.is-muted {
  background: var(--muted-background);
  box-shadow: inset 0 0 0 2px var(--muted-border-color);
  pointer-events: auto;
}

/* === QUICK BUTTON ANIMATIONS === */
/* Grow animation applied to Quick Buttons on "Let's Go!" confirmation */
/* Animation defined in: src/styles/utils/_animations-general.css (quick-button-grow-snap) */
.icon-bar-item.is-animating-quick-button {
  animation: quick-button-grow-snap 600ms ease-out forwards;
  transform-origin: center center;
  will-change: transform;
}

/* === RESPONSIVE LAYOUT === */
/* CEMENT: Narrow viewport strategy - lock focus icon, compress plan/session */
@media (max-width: 389px) {
  .icon-bar {
    flex-wrap: nowrap;
  }

  .icon-bar-item.icon-display {
    width: 50px;
    min-width: 50px;
    max-width: 50px;
    flex-shrink: 0;
  }

  .icon-bar-item.icon-plan-wide,
  .icon-bar-item.icon-session-wide {
    flex: 1;
    min-width: 0;
  }
}
