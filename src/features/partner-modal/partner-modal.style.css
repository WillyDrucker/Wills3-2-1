/* ==========================================================================
   PARTNER MODAL

   Modal dialog for configuring partner workouts with two-user selection.
   Triggered from config-card Partner button.

   Purpose:
   - Allows two users to select their workout days for partner mode
   - Green/blue color scheme differentiates User 1 (green) and User 2/Partner (blue)
   - Visual divider separates the two user sections
   - Enforces mutual exclusivity with superset mode

   Base Styles:
   Inherits all base styling from _confirmation-modals.css:
   - Title: 2.5rem/700 centered
   - Card: max-width 400px, blue border, standard padding
   - Button layout: Two-button flex with 16px gap
   - 16px spacing rhythm throughout

   Custom Features:
   - Instant modal appearance (transition: none overrides global fade-in)
   - Two user sections with muted profile selectors (read-only display, full-color text)
   - Active day selectors for each user with grow/color animations
   - Selection feedback animations (olive â†’ green/blue flash â†’ stay colored)
     - User 1 Focus: Flashes green, stays green (uses workout log animation pattern)
     - Partner Focus: Flashes blue, stays blue (uses workout log animation pattern)
   - Visual divider with compensated spacing (16px visual both sides)
   - User profile text with two-toned styling (label + value)
   - "Current User Profile", "Current User Focus", "Partner Profile", "Partner Focus" labels (1.25rem/600, left-aligned)
   - Precise spacing: 16px â†’ label â†’ 7px â†’ selector â†’ 16px â†’ next label

   Architecture:
   Title â†’ 16px â†’ "Current User Profile" â†’ 7px â†’ User 1 Profile (muted, green) â†’ 16px â†’
   "Current User Focus" â†’ 7px â†’ User 1 Day Selector (active, green) â†’ 16px â†’
   Divider â†’ 16px â†’ "Partner Profile" â†’ 7px â†’ User 2 Profile (muted, blue) â†’ 16px â†’
   "Partner Focus" â†’ 7px â†’ User 2 Day Selector (active, blue) â†’ 16px â†’ Cancel/Partner Up! buttons

   Dependencies:
   - _confirmation-modals.css: Base confirmation modal pattern
   - _modals.css: Modal container system, modal-divider styling
   - _card-headers.css: "With" header styling
   - _variables.css: Spacing tokens (--modal-section-spacing, --space-m, --header-margin-bottom)

   Used by: Config-card Partner button, dual-mode workout system
   ========================================================================== */

/* Global dependencies */
@import url("../../styles/components/_modals.css");
@import url("../../styles/components/_card-headers.css");
@import url("../../styles/components/_action-button-groups.css");
@import url("../../styles/components/_confirmation-modals.css");

/* ==========================================================================
   PARTNER-SPECIFIC STYLES ONLY
   All base confirmation modal styles come from _confirmation-modals.css
   ========================================================================== */

/* === MODAL CONTAINER OVERRIDE === */
/* ðŸ”’ CEMENT: Instant appearance - !important overrides global modal fade-in */
#partner-modal-container {
  transition: none !important;
}

/* === FOCUS LABELS === */
/* Override center alignment from global - left align to match selectors */
.partner-card .confirmation-modal-question {
  text-align: left;
  margin-left: 0;
  margin-right: 0;
}

/* "Current User Profile" - First label after title */
.partner-card .confirmation-modal-question:first-of-type {
  margin-top: 8px; /* 16px visual from title */
  margin-bottom: var(--header-margin-bottom); /* 4px + 3px descender = 7px visual to selector */
}

/* Labels between selectors */
.partner-card .partner-section-label {
  margin-top: 14px; /* 16px visual from selector */
  margin-bottom: var(--header-margin-bottom); /* 4px + 3px descender = 7px visual to selector */
}

/* Label after divider needs more space */
.partner-card .modal-divider + .confirmation-modal-question {
  margin-top: 16px; /* 16px visual from divider */
}

/* === SELECTORS === */
.partner-card .app-selector {
  margin-bottom: 0; /* Stack handles spacing */
  /* Force GPU rendering at all times to prevent rendering mode shifts */
  transform: translateZ(0);
  backface-visibility: hidden;
  -webkit-font-smoothing: antialiased;
  position: relative; /* Establish positioning context for z-index */
  z-index: 1; /* Base z-index */
}

/* === CUSTOM SELECTOR DISPLAY === */
/* Selector display acts like summary - clickable to toggle (for day selectors only) */
.partner-card .app-selector .selector-display {
  background-color: var(--background-dark);
  box-shadow: inset 0 0 0 2px var(--primary-blue);
  border-radius: var(--border-radius);
  min-height: var(--control-height); /* Global: 50px */
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 10px 16px;
  cursor: pointer;
}

/* Hide options list by default */
.partner-card .app-selector .options-list {
  display: none;
}

/* Show options list when selector is open */
.partner-card .app-selector.is-open .options-list {
  display: block;
}

/* When selector opens, raise z-index so dropdown appears above siblings */
.partner-card .app-selector.is-open {
  z-index: 10; /* Above other selectors */
}

/* Square bottom corners when open to connect to dropdown */
.partner-card .app-selector.is-open .selector-display {
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0;
}

/* Current User Focus selector needs 16px to divider */
.partner-card #partner-user1-day-selector {
  margin-bottom: 18px; /* 16px visual to divider */
}

/* === DIVIDER === */
/* ðŸ”’ CEMENT: 16px visual spacing both sides of divider for balance */
.partner-card .modal-divider {
  margin: 13px 0 13px 0; /* 13px both sides = 16px visual */
}

/* Partner Focus selector needs 16px to buttons */
.partner-card #partner-user2-day-selector {
  margin-bottom: var(--space-m); /* 16px to buttons */
}

/* === WRAP THEN TRUNCATE PATTERN === */
/* Hybrid layout: wraps to multiple lines first, then truncates each line if needed */
.partner-card .selector-content.wrap-then-truncate {
  display: block;
  text-align: center;
  padding: var(--selector-multiline-padding-top) 0 var(--selector-multiline-padding-bottom) 0;
  line-height: var(--selector-multiline-line-height);
  white-space: normal; /* Allow wrapping between spans */
  overflow: hidden; /* Enable truncation context */
}

.partner-card .selector-content.wrap-then-truncate span {
  display: inline-block; /* Inline flow (wraps naturally), block formatting (allows truncation) */
  max-width: 100%; /* Full width when wrapped to own line */
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap; /* Truncate within each span if too long */
  vertical-align: bottom; /* Align baselines when on same line */
}

/* === USER PROFILES === */
/* Profile selectors forced to 50px height to match all other selectors */
#partner-user1-profile-selector > summary,
#partner-user2-profile-selector > summary {
  height: 50px; /* Override min-height to enforce consistent 50px height */
}

/* Profile selector exception - content stays visible (full color) even when muted */
/* Selectors remain muted (background/border) but text displays at full brightness */
#partner-user1-profile-selector.app-selector.is-muted > summary .selector-content,
#partner-user1-profile-selector.app-selector.is-muted[open] > summary .selector-content,
#partner-user2-profile-selector.app-selector.is-muted > summary .selector-content,
#partner-user2-profile-selector.app-selector.is-muted[open] > summary .selector-content {
  filter: none;
  opacity: 1;
}

/* === ANIMATIONS === */

/* Selector grow/snap animation - based on workout log stamp */
@keyframes selector-grow-snap {
  0% {
    transform: scale(1);
  }
  90% {  /* 900ms grow phase */
    transform: scale(1.15);
  }
  100% { /* 100ms snap back */
    transform: scale(1);
  }
}

/* Apply grow animation to selector container */
.app-selector.is-animating-selector {
  animation: selector-grow-snap 1s ease-out forwards;
  transform-origin: center center;
  will-change: transform; /* GPU acceleration */
}

/* Green color transition - olive to green (matches superset pattern) */
@keyframes selector-green-glow-transition {
  0% {
    color: var(--text-olive-deviation); /* Start olive */
    text-shadow: 0 0 8px var(--text-green-plan); /* Start with visible green glow */
  }
  100% {
    color: var(--text-green-plan); /* End at green */
    text-shadow: 0 0 20px var(--text-green-plan); /* Larger green glow */
  }
}

/* Blue color transition - olive to blue (Partner User 2) */
@keyframes selector-blue-glow-transition {
  0% {
    color: var(--text-olive-deviation); /* Start olive */
    text-shadow: 0 0 8px var(--primary-blue); /* Start with visible blue glow */
  }
  100% {
    color: var(--primary-blue); /* End at blue */
    text-shadow: 0 0 20px var(--primary-blue); /* Larger blue glow */
  }
}

/* User 1 Focus - transitions to green with green glow in parallel with grow */
/* Higher specificity overrides .data-highlight.text-plan */
.data-highlight.is-transitioning-to-green,
.is-transitioning-to-green {
  animation: selector-green-glow-transition 1000ms ease-out forwards;
  will-change: color, text-shadow; /* GPU acceleration */
}

/* Partner Focus - transitions to blue with blue glow in parallel with grow */
/* Higher specificity overrides .data-highlight.text-primary */
.data-highlight.is-transitioning-to-blue,
.is-transitioning-to-blue {
  animation: selector-blue-glow-transition 1000ms ease-out forwards;
  will-change: color, text-shadow; /* GPU acceleration */
}