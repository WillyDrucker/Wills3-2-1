/* ==========================================================================
   SUPERSET/PARTNER DUAL-MODE STYLES
   
   CEMENT: Specialized spacing for dual-mode active states
   - Timer line-height: 0.7 (only in dual-mode)
   - Resting to timer: 16px
   - Resting to Log Set: 23px (via 7px margin adjustment)
   - Timer to Skip Rest: 16px via gap
   
   DO NOT modify without testing both superset and partner modes
   ========================================================================== */

/* === TIMER DISPLAY === */

#active-card-container .timer-display {
  font-size: 5rem;
  font-weight: 700;
  line-height: 0.7;
}

/* === DUAL-MODE GRID LAYOUT === */

/* CEMENT: Independent columns prevent layout interaction */
#active-card-container .dual-action-area-container {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
  align-items: start; /* Critical for column independence */
}

/* === TIMER AND SKIP CONTAINER === */

/* CEMENT: Timer to Skip Rest = 16px via flex gap */
.timer-and-skip-container {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

/* === DUAL-MODE SPECIFIC TIMER === */

/* CEMENT: Timer line-height locked to 0.7 in dual-mode only */
#active-card-container .dual-action-area-container .timer-display {
  line-height: 0.7;
}

/* === RESTING STATE SPACING === */

/* CEMENT: Resting to Grid locked to 16px */
#active-card-container .action-prompt-block.is-resting + .dual-action-area-container {
  margin-top: 0;
}

/* === OPPOSITE LOG SET ADJUSTMENT === */

/* CEMENT: Opposite Log Set extra = 7px (23px total from Resting) */
#active-card-container .dual-action-area-container:has(.action-area-cell > .timer-and-skip-container)
  .action-area-cell:has(> .action-button-group) {
  margin-top: 7px;
}

/* Safety: avoid double-spacing inside cells */
#active-card-container .dual-action-area-container .action-area-cell > * {
  margin-top: 0;
  margin-bottom: 0;
}

/* === SUPERSET/PARTNER ACTIVE-ONLY RHYTHM === */

/* Higher specificity timer line-height */
#active-card-container .dual-action-area-container .timer-and-skip-container .timer-display {
  line-height: 0.7;
}

/* Neutralize internal spacers around the "Resting For:" block */
#active-card-container .action-prompt-block.is-resting .action-prompt-spacer-top,
#active-card-container .action-prompt-block.is-resting .action-prompt-spacer-bottom {
  height: 0;
  margin: 0;
  padding: 0;
}

#active-card-container .action-prompt-block.is-resting .resting-label {
  margin: 0;
  line-height: 1.25;
}

/* Exact 16px from "Resting For:" to the grid */
#active-card-container .action-prompt-block.is-resting + .dual-action-area-container {
  margin-top: 0;
}

/* When the opposite column is Log Set (no timer), add spacing for 23px total */
#active-card-container .dual-action-area-container:has(.action-area-cell > .timer-and-skip-container)
  .action-area-cell:has(> .action-button-group) {
  margin-top: 7px;
}

/* Safety guards to avoid double margins/padding inside cells */
#active-card-container .dual-action-area-container .action-area-cell {
  margin: 0;
  padding-top: 0;
}

#active-card-container .dual-action-area-container .action-area-cell > * {
  margin-top: 0;
  margin-bottom: 0;
}

/* === HIGH-SPECIFICITY OVERRIDES === */

/* CEMENT: Dual-mode timers use 0.7 line-height; beats normal-card rule */
#active-card-container #card-action-area .dual-action-area-container .timer-display,
#active-card-container #card-action-area .dual-action-area-container .timer-and-skip-container .timer-display {
  line-height: 0.7;
}

/* === PARENT STACK CONFIGURATION === */

/* Ensure the parent stack uses a 16px gap between Resting and the dual grid */
#active-card-container #card-action-area.stack:has(> .action-prompt-block.is-resting):has(> .dual-action-area-container) {
  --stack-space: 16px;
}

/* Dual-mode resting block must contribute zero vertical space */
#active-card-container #card-action-area.stack > .action-prompt-block.is-resting {
  margin: 0;
  padding: 0;
}

#active-card-container #card-action-area.stack > .action-prompt-block.is-resting > * {
  margin: 0;
  padding: 0;
}

/* === VISUAL MICRO-TUNING === */

/* Parent-scoped tokens for centralized adjustments */
#active-card-container #card-action-area.stack:has(> .action-prompt-block.is-resting):has(> .dual-action-area-container) {
  --sp-cap-fix-label-bottom: -4px;     /* Trims Resting to Grid by 4px to land at 16px */
  --sp-cap-fix-opposite-logset-adjust: -5px; /* Trims opposite Log Set by 5px */
  --sp-opposite-logset-margin-top: 6px; /* Resting to Log Set total = 16 + 7 = 23px */
}

/* Apply label bottom trim */
#active-card-container #card-action-area.stack > .action-prompt-block.is-resting .resting-label {
  margin-bottom: -4px;
}

/* CEMENT: Opposite Log Set extra = 6px (23px total) */
#active-card-container .dual-action-area-container:has(.action-area-cell > .timer-and-skip-container)
  .action-area-cell:has(> .action-button-group) {
  margin-top: 6px;
}

/* Ensure Skip Rest button is 16px below timer */
#active-card-container .dual-action-area-container .timer-and-skip-container {
  gap: 16px;
}

#active-card-container .dual-action-area-container .timer-and-skip-container > * {
  margin-top: 0;
  margin-bottom: 0;
}

/* === FINAL DUAL-MODE CORRECTIONS === */

/* Token host for dual-mode resting state */
#active-card-container #card-action-area.stack:has(> .action-prompt-block.is-resting):has(> .dual-action-area-container) {
  --stack-space: 16px;
  --sp-opposite-logset-margin-top: 6px; /* Fine-tuned for 23px visual */
}

/* Resting block contributes zero extra vertical space */
#active-card-container #card-action-area.stack > .action-prompt-block.is-resting,
#active-card-container #card-action-area.stack > .action-prompt-block.is-resting > * {
  margin: 0;
  padding: 0;
}

/* Resting to Grid controlled solely by stack gap */
#active-card-container .action-prompt-block.is-resting + .dual-action-area-container {
  margin-top: 0;
}

/* Opposite Log Set gets the extra margin so total = 23px */
#active-card-container .dual-action-area-container:has(.action-area-cell > .timer-and-skip-container)
  .action-area-cell:has(> .action-button-group) {
  margin-top: 6px;
}

/* Timer line-height - high specificity to beat normal-card line-height */
#active-card-container #card-action-area .dual-action-area-container .timer-display,
#active-card-container #card-action-area .dual-action-area-container .timer-and-skip-container .timer-display {
  line-height: 0.7;
}

/* Timer to Skip Rest gap = 16px, no clipping */
#active-card-container #card-action-area .dual-action-area-container .timer-and-skip-container {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

/* Safety: zero inside margins so nothing stacks */
#active-card-container #card-action-area .dual-action-area-container .action-area-cell > * {
  margin-top: 0;
  margin-bottom: 0;
}