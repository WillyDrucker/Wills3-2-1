/* ==========================================================================
   HELPERS - Global utility classes

   CEMENT: Reusable utility classes for layout, text, and color patterns
   - Layout: .stack for vertical rhythm with gap-based spacing
   - Text: .truncate-text for ellipsis truncation in any context
   - Colors: Data-driven color classes (.text-plan, .text-warning, etc.)
   - Muting: Legacy muting styles (NOTE: Primary muting in _selectors-muting.css)

   Utilities defined:
   1. .stack - Flex column with gap spacing (customizable via --stack-space)
   2. .truncate-text - Universal ellipsis truncation (flex/grid/block compatible)
   3. .text-* classes - Semantic color utilities matching data states
   4. .is-muted - Legacy muting styles (coexists with _selectors-muting.css)
   5. body.is-selector-open - Global selector state management

   CEMENT: Gap-based spacing prevents margin collapse inconsistencies
   - Modern approach with pixel-perfect control
   - Customizable via --stack-space variable (defaults to --space-m)

   Dependencies:
   Global: _variables.css (spacing, color tokens, muting tokens)

   Used by: Most components (layout stacks, text truncation, color coding)
   ========================================================================== */

/* === LAYOUT PRIMITIVE: STACK === */
/* CEMENT: Core vertical rhythm system using gap for consistent spacing */
.stack {
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  gap: var(--stack-space, var(--space-m)); /* Default 16px, customizable */
}

/* --- UNIVERSAL MUTING LOGIC --- */

/* This class fully disables a selector (border and interaction) */
.is-muted {
  pointer-events: none;
}
.is-muted > summary {
  background-color: var(--background-dark);
  box-shadow: inset 0 0 0 2px var(--primary-blue-dark);
}
.is-muted > summary .selector-content {
  opacity: 0.2;
}

/* CORRECTED: This special case keeps the exercise selector text visible when disabled */
details#exercise-selector.is-muted > summary .selector-content {
  opacity: 1;
}

/* ðŸ”’ CEMENT: One-selector-to-rule-them-all override for exercise selector muting behavior
   High-specificity rule ensures exercise selector fully mutes when another selector opens
   Essential for maintaining consistent muting behavior across all selector states */
body.is-selector-open details#exercise-selector.is-muted > summary .selector-content {
  opacity: 0.2;
  filter: brightness(0.5) saturate(0.5);
}

/* This class mutes ONLY the content, leaving the border and interaction active. */
summary.is-content-muted .selector-content {
  opacity: 0.2;
}

/* --- GLOBAL OVERRIDE when ANY selector is open --- */

body.is-selector-open details:not([open]) {
  pointer-events: none;
}

/*
  CEMENTED (v5.0.6 - Architectural Fix):
  The `:not(.workout-log-item-container)` pseudo-class is the key to decoupling.
  It applies the generic "squaring" mute effect to all standard selectors, but
  EXCLUDES the workout log, allowing its component-specific styles to take precedence.
*/
body.is-selector-open
  details:not(.workout-log-item-container):not([open])
  > summary {
  background-color: var(--background-dark);
  box-shadow: inset 0 0 0 2px var(--primary-blue-dark);
}
body.is-selector-open
  details:not(.workout-log-item-container):not([open])
  > summary
  .selector-content {
  opacity: 0.2;
}

.options-list li.is-muted {
  pointer-events: none;
  filter: brightness(0.5) saturate(0.5);
  opacity: 0.7;
}

/* --- CEMENTED: Text Truncation --- */
/* This is the definitive, robust truncation class. It works in flex, grid, and block contexts. */
.truncate-text {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  min-width: 0; /* Allows element to shrink in flex/grid containers */
}

/* --- Data-driven Color Classes --- */
.data-highlight.text-plan,
.text-plan {
  color: var(--text-green-plan);
}
.data-highlight.text-warning,
.text-warning {
  color: var(--text-yellow-maintenance);
}
.data-highlight.text-deviation,
.text-deviation {
  color: var(--text-olive-deviation);
}
.data-highlight.text-orange,
.text-orange {
  color: var(--text-orange-deviation);
}
.data-highlight.text-skip,
.text-skip {
  color: var(--text-red-skip);
}
.text-primary {
  color: var(--primary-blue);
}
/* CEMENTED FIX (v5.1.2): New utility class for informational text. */
.text-info {
  color: var(--on-surface-medium);
}
/* Utility class for committed workout data (green text) */
.text-success {
  color: var(--text-green-plan);
}