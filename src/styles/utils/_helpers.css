/* --- REFACTOR: New Layout Primitive (The Stack) --- */
/*
  This is the core of the new "Rhythm & Flow" system.
  It creates consistent, "natural" vertical spacing.
*/
.stack {
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  /*
    PROACTIVE IMPROVEMENT (Phase 2):
    Switched from a margin-based approach to `gap`. The `gap` property is
    the modern, definitive way to control spacing between flex items. It is
    not affected by margin collapsing or other browser inconsistencies,
    giving us true, pixel-perfect control over the layout rhythm.
  */
  gap: var(--stack-space, var(--space-m));
}

/* --- UNIVERSAL MUTING LOGIC --- */

/* This class fully disables a selector (border and interaction) */
.is-muted {
  pointer-events: none;
}
.is-muted > summary {
  background-color: var(--background-dark);
  box-shadow: inset 0 0 0 2px var(--primary-blue-dark);
}
.is-muted > summary .selector-content {
  opacity: 0.2;
}

/* CORRECTED: This special case keeps the exercise selector text visible when disabled */
details#exercise-selector.is-muted > summary .selector-content {
  opacity: 1;
}

/* This class mutes ONLY the content, leaving the border and interaction active. */
summary.is-content-muted .selector-content {
  opacity: 0.2;
}

/* --- GLOBAL OVERRIDE when ANY selector is open --- */

body.is-selector-open details:not([open]) {
  pointer-events: none;
}

/*
  CEMENTED (v5.0.6 - Architectural Fix):
  The `:not(.workout-log-item-container)` pseudo-class is the key to decoupling.
  It applies the generic "squaring" mute effect to all standard selectors, but
  EXCLUDES the workout log, allowing its component-specific styles to take precedence.
*/
body.is-selector-open
  details:not(.workout-log-item-container):not([open])
  > summary {
  background-color: var(--background-dark);
  box-shadow: inset 0 0 0 2px var(--primary-blue-dark);
}
body.is-selector-open
  details:not(.workout-log-item-container):not([open])
  > summary
  .selector-content {
  opacity: 0.2;
}

.options-list li.is-muted {
  pointer-events: none;
  filter: brightness(0.5) saturate(0.5);
  opacity: 0.7;
}

/* --- CEMENTED: Text Truncation --- */
/* This is the definitive, robust truncation class. It works in flex, grid, and block contexts. */
.truncate-text {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  min-width: 0; /* Allows element to shrink in flex/grid containers */
}

/* --- Data-driven Color Classes --- */
.data-highlight.text-plan,
.text-plan {
  color: var(--text-green-plan);
}
.data-highlight.text-warning,
.text-warning {
  color: var(--text-yellow-maintenance);
}
.data-highlight.text-deviation,
.text-deviation {
  color: var(--text-olive-deviation);
}
.data-highlight.text-orange,
.text-orange {
  color: var(--text-orange-deviation);
}
.data-highlight.text-skip,
.text-skip {
  color: var(--text-red-skip);
}
.text-primary {
  color: var(--primary-blue);
}
/* CEMENTED FIX (v5.1.2): New utility class for informational text. */
.text-info {
  color: var(--on-surface-medium);
}