{
  "project": "Will's 3-2-1 Workout Tracking Application",
  "version": "5.4.7",
  "philosophy": "SUPER STUPID SIMPLE (SSS), REMOVE DON'T ADD",
  "tech_stack": "Vanilla JavaScript, ES Modules, CSS Tokens",

  "critical_dependencies": {
    "global_css_reset": "src/styles/base/_reset.css - Contains * { margin: 0; padding: 0; } requiring !important overrides",
    "import_map": "index.html - ES module bare specifier mapping for native browser support",
    "app_state": "src/state.js - Centralized state management",
    "render_system": "src/main.js - renderAll() pattern for full UI updates"
  },

  "file_structure": {
    "root": {
      "index.html": "Main entry point with ES module import map",
      "APD/": {
        "CLAUDE.md": "Main system instructions for Claude Code",
        "CLAUDE_STANDARDS.md": "5 development standards (handoff, CEMENT, CSS, tokens, naming)",
        "CLAUDE_SESSION_HANDOFF.md": "Current session status and next priorities",
        "CLAUDE_PROJECT_NOTES.md": "Version changelog and technical discoveries"
      }
    },

    "src/": {
      "main.js": "Bootstrap with renderAll() system",
      "state.js": "Centralized appState object",
      "config.js": "Application constants and endpoints",

      "features/": {
        "dual-mode/": {
          "dual-mode.style.css": "Main entry point for dual-mode imports",
          "dual-mode.layout.css": "ðŸ”’ CSS table with transparent borders (prevents 2px shift)",
          "dual-mode.spacing.css": "Tokenized spacing (16-18px rhythm)",
          "dual-mode.colors.css": "Static color schemes (Superset green/yellow, Partner green/blue)",
          "dual-mode.header.css": "Card header with muscle group icons",
          "dual-mode.selector.css": "Exercise selector dual-mode styling",
          "dual-mode.fuel-gauge.css": "Side-by-side fuel gauge layout",
          "dual-mode.timers.css": "Side-by-side timer display (4.5rem font)",
          "dual-mode.active-card.css": "General active card dual-mode overrides",
          "dual-mode.partner-modal.css": "Partner-specific green/blue styling",
          "dual-mode.superset-modal.css": "Superset-specific green/yellow styling"
        },

        "active-exercise-card/": {
          "active-exercise-card.index.js": "Component entry point with re-exports",
          "active-exercise-card.template.js": "Template selector (rest/completion/workout)",
          "active-exercise-card.templates.workoutCard.js": "Workout card HTML generation",
          "active-exercise-card.templates.completionCard.js": "Completion card with animation",
          "active-exercise-card.templates.exerciseSelector.js": "Exercise selector dropdown",
          "active-exercise-card.templates.actionArea.js": "Action buttons area with ðŸ”’ static colors",
          "active-exercise-card.templates.fuelGauge.js": "Fuel gauge animations",
          "active-exercise-card.numberInputHandler.js": "Press-and-hold input logic",
          "active-exercise-card.actions.js": "Re-exports + input/swap handlers",
          "active-exercise-card.actions.log.js": "handleLogSet function",
          "active-exercise-card.actions.skip.js": "handleSkipSet, handleSkipRest",
          "active-exercise-card.style.css": "Main entry point (imports all CSS)",
          "active-exercise-card.header.css": "Card header with flexbox truncation",
          "active-exercise-card.fuel-gauge.css": "Fuel gauge with 'Recovering' overlay",
          "active-exercise-card.inputs.css": "Weight/reps input grid",
          "active-exercise-card.actions.css": "Log Set/Skip Set/Skip Rest buttons",
          "active-exercise-card.selector.css": "Entry point (re-imports split selector files)",
          "active-exercise-card.selector.summary.css": "ðŸ”’ Closed state (4-line, 100px height)",
          "active-exercise-card.selector.dropdown.css": "Open dropdown (50px items)",
          "active-exercise-card.selector.muting.css": "Bidirectional muting (Exercise â†” Config â†” Log)",
          "active-exercise-card.youtube-overlay.css": "YouTube button overlay",
          "active-exercise-card.waiting-card.css": "'Finishing up...' card"
        },

        "config-card/": {
          "config-card.index.js": "Configuration logic and handlers",
          "config-card.style.css": "Main entry point (reference architecture)",
          "config-card.selectors.css": "Two-line selector patterns",
          "config-card.header.index.js": "Collapsible header logic with click-outside",
          "config-card.header.template.js": "Header template selector",
          "config-card.header.template.collapsed.js": "Icon bar (Plan/Focus/Session)",
          "config-card.header.template.expanded.js": "Full config with selectors",
          "config-card.header.style.css": "Icon bar and quick buttons",
          "config-card.header.expanded.css": "Expanded state with selectors",
          "config-card.header.muting.css": "ðŸ”’ Bidirectional muting (Config â†” Log)",
          "config-card.template.daySelector.js": "Day selector HTML",
          "config-card.template.planSelector.js": "Plan selector HTML",
          "config-card.template.time.js": "ðŸ”’ Shared session selector (Normal/Superset/Partner)",
          "config-card.template.currentSetup.js": "Current setup display"
        },

        "workout-log/": {
          "workout-log.index.js": "Log component logic",
          "workout-log.template.js": "Log item templates",
          "workout-log.style.css": "Main entry point (imports components)",
          "workout-log.header.css": "ðŸ”’ 'Today's Workout' (line-height: 1, 7px gap)",
          "workout-log.items.css": "50px log item cards with absolute positioning",
          "workout-log.edit-panel.css": "Weight/reps edit controls",
          "workout-log.states.css": "Completed/skipped/updating states",
          "workout-log.animations.css": "Grow/snap and green flash animations"
        },

        "fuel-gauge/": {
          "fuel-gauge.style.css": "Main entry point",
          "fuel-gauge.layout.css": "Base structure",
          "fuel-gauge.colors.css": "Dynamic/static color states",
          "fuel-gauge.animations.css": "60s fill, 1.2s stamp, 4s fade"
        },

        "superset-modal/": {
          "superset-modal.index.js": "Superset logic with ðŸ”’ config lock",
          "superset-modal.style.css": "Dual-day selection modal",
          "superset-modal.template.js": "Modal HTML"
        },

        "partner-modal/": {
          "partner-modal.index.js": "Partner logic with ðŸ”’ config lock",
          "partner-modal.style.css": "User profile modal",
          "partner-modal.template.js": "Modal HTML"
        },

        "reset-confirmation-modal/": {
          "reset-confirmation-modal.index.js": "Reset confirmation logic",
          "reset-confirmation-modal.template.js": "Confirmation HTML",
          "reset-confirmation-modal.style.css": "Modal confirmation styling"
        },

        "video-player/": {
          "video-player.index.js": "YouTube video player logic",
          "video-player.style.css": "Modal video player styling"
        },

        "side-nav/": {
          "side-nav.index.js": "Navigation menu logic",
          "side-nav.style.css": "Slide-out navigation styling"
        },

        "app-header/": {
          "app-header.style.css": "Navigation and branding"
        },

        "home-page/": {
          "home-page.style.css": "Landing page layout"
        },

        "my-data/": {
          "my-data.index.js": "Data visualization logic",
          "my-data.templates.calendarView.js": "Calendar view templates",
          "my-data.style.css": "Data visualization and calendar",
          "my-data.header.css": "Data page header styling",
          "my-data.calendar.css": "Calendar grid and navigation"
        },

        "workout-results-card/": {
          "workout-results-card.index.js": "Results display logic",
          "workout-results-card.style.css": "Results card styling",
          "workout-results-card.animations.css": "Results reveal animations"
        }
      },

      "services/": {
        "core/": {
          "appInitializerService.js": "Application startup and initialization",
          "navigationService.js": "Page routing and navigation state",
          "persistenceService.js": "Local storage state persistence"
        },

        "actions/": {
          "actionService.js": "ðŸ”’ Event delegation (summary BEFORE data-action)",
          "actionHandlers.js": "All data-action callbacks with ðŸ”’ config header locking"
        },

        "timer/": {
          "timerService.js": "Core timer state and control (85 lines)",
          "timerCompletionService.js": "Rest completion handlers (normal/superset, 106 lines)",
          "timerResumptionService.js": "Visibility-based timer resumption (102 lines)"
        },

        "workout/": {
          "workoutService.js": "Re-export index for backward compatibility (34 lines)",
          "workoutStateService.js": "Active card state management (117 lines)",
          "workoutLogGenerationService.js": "Workout log creation (187 lines)",
          "workoutLogPreservationService.js": "Log preservation during swaps (116 lines)",
          "workoutProgressionService.js": "Workout advancement logic (178 lines)",
          "workoutMetricsService.js": "Duration calculations (67 lines)"
        },

        "ui/": {
          "modalService.js": "Modal management and state",
          "scrollService.js": "Scroll utilities and viewport detection",
          "selectorService.js": "Selector state and group-based muting"
        },

        "data/": {
          "historyService.js": "Workout history and data persistence"
        }
      },

      "styles/": {
        "index.css": "Main CSS manifest with organized feature imports",
        "base/": {
          "_variables.css": "ðŸ”’ Global CSS tokens (16px/7px rhythm, --header-margin-bottom: 4px)",
          "_reset.css": "CRITICAL: Global reset (* { margin: 0; padding: 0; })",
          "_typography.css": "Font definitions and text styling",
          "_scaffolding.css": "App container and layout structure"
        },
        "components/": {
          "_buttons.css": "Button component patterns",
          "_inputs.css": "Form input styling",
          "_selectors.css": "Dropdown and selection components",
          "_modals.css": "Modal overlay and container patterns",
          "_card-headers.css": "ðŸ”’ Universal header (line-height: 1, margin-bottom: 4px)",
          "_card-foundations.css": "ðŸ”’ Base card (11px top + ascender = 16px visual)",
          "_action-button-groups.css": "Action button layouts"
        },
        "utils/": {
          "_helpers.css": "Stack layout utility and helper classes",
          "_animations.css": "General animation keyframes"
        },
        "themes/": {
          "_default.css": "Default theme variables",
          "_dark.css": "Dark theme overrides"
        }
      },

      "shared/": {
        "ui.js": "Re-export from utils/uiComponents.js (backward compatibility)",
        "utils.js": "Re-export index (backward compatibility)",
        "utils/": {
          "timeUtils.js": "Time/date formatting (formatTime, getTodayDayName, 87 lines)",
          "calendarUtils.js": "Calendar calculations for My Data (getWeekRange, 91 lines)",
          "domUtils.js": "DOM manipulation (scrollToElement, loadScriptOnce, 53 lines)",
          "generalUtils.js": "Misc helpers (getYouTubeVideoId, getNextWorkoutDay, 90 lines)",
          "uiComponents.js": "UI builders (createNumberInputHTML, createSelectorHTML) + ui refs (79 lines)",
          "sessionValidation.js": "ðŸ”’ Session cycling validation (canCycleToSession, 139 lines)"
        }
      },

      "lib/": {
        "wakeLock.js": "ðŸ”’ Screen wake lock (visibility check prevents background error)",
        "fullscreen.js": "Fullscreen API wrapper"
      }
    }
  },

  "critical_notes": {
    "event_delegation_order": "ðŸ”’ CEMENT: Summary clicks BEFORE data-action (prevents scroll jump)",
    "css_spacing_system": "ðŸ”’ 16px/7px rhythm: line-height: 1 + margin-bottom: 4px (+ 3px descender)",
    "backward_compatibility": "utils.js, ui.js are re-export indexes (maintains existing imports)",
    "service_architecture": "Timer: 3 files, Workout: 6 files (100-200 line guideline)",
    "config_header_locking": "ðŸ”’ Lock prevents collapse during selector operations",
    "wake_lock_visibility": "ðŸ”’ Check visibilityState before request (prevents NotAllowedError)",
    "dual_mode_layout": "ðŸ”’ CSS table with transparent borders (eliminates 2px shift)",
    "selector_muting": "Bidirectional: Config â†” Exercise â†” Log (border-only preserves visibility)"
  },

  "architecture_patterns": {
    "component_pattern": "Each feature: .index.js (logic), .template.js (HTML), .style.css (styles)",
    "state_flow": "User action â†’ Service method â†’ appState mutation â†’ renderAll() â†’ persistenceService.saveState()",
    "file_splitting": "Split when concerns are logically separable (100-200 line guideline)",
    "css_imports": "Entry point imports all component files (prevents duplicate imports)",
    "re_export_indexes": "Old monolithic files become re-exports for gradual migration"
  }
}
